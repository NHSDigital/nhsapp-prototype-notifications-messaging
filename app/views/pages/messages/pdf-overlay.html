{% extends 'layout-ios-sms.html' %}
{% block content %}

  <div class="nhsuk-grid-row">
    <div class="nhsuk-grid-column-full">

      {{ dynamicPageTitle({
        title: pageHeading
      })}}

      <!-- OVERLAY CONTENT -->
      <div class="nhsapp-pdf-overlay__content" style="position:relative;">

        <!-- Header bar: 64px, background #0C0C0C, contains close link (left) and centered title -->
        <div class="pdf-header" role="">
          <a id="iosGlassClose" class="ios-glass-close" href="/pages/messages/paper-copy" aria-label="Close - button" title="Close preview">
            <svg width="20" height="20" viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="none" stroke="#ffffff" stroke-width="3.2" stroke-linecap="round" stroke-linejoin="round" role="img" aria-label="Close">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </a>

          <div class="pdf-domain-title" role="Address" aria-level="2">england.nhs.uk</div>
        </div>

        <!-- Main content area below header (uses #808080 background) -->
        <div class="pdf-main">
          <!-- Embedded PDF (static asset) -->
          <embed src="https://pdfscreenreadertesting.blob.core.windows.net/pdf/Royal-Berkshire-Dermatology-Letter.pdf" width="100%" height="1500" type="application/pdf">

          <!-- iOS button group image overlaid above the PDF (now full-width at bottom) -->
          <img class="ios-toolbar" src="/images/bottom-toolbar.svg" alt="iOS button groups" name="button" />
        </div>

      </div> 
    </div>
  </div> 

  <style>
    /* Page background for remainder of page */
    html, body { background-color: #808080 !important; }

    /* Header: 64px with dark page background, fixed to top of viewport */
    .pdf-header {
      height: 64px;
      background: #0C0C0C;
      display: flex;
      align-items: center;
      justify-content: center; /* center the title horizontally */
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      padding-left: calc(env(safe-area-inset-left, 0px) + 12px);
      padding-right: calc(env(safe-area-inset-right, 0px) + 12px);
      z-index: 9999;
      -webkit-backface-visibility: hidden;
    }

    /* Centered SF Pro-style domain title inside header */
    .pdf-domain-title {
      font-family: -apple-system, "SF Pro Text", "SF Pro Display", "Helvetica Neue", Arial, sans-serif;
      font-weight: 600; /* semibold */
      font-size: 15px;
      line-height: 1;
      color: #FFFFFF;
      text-align: center;
      pointer-events: none;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    /* Ensure the close control is vertically centered in the header and fixed at left */
    .ios-glass-close {
      position: absolute;
      left: calc(env(safe-area-inset-left, 0px) + 12px);
      top: 50%;
      transform: translateY(-50%);
      width: 44px;
      height: 44px;
      padding: 0;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.08);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15), inset 0 1px 0 rgba(255,255,255,0.04);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      color: #ffffff;
      cursor: pointer;
      z-index: 60;
      transition: transform .16s cubic-bezier(0.34, 1.56, 0.64, 1), background-color .12s ease, box-shadow .12s ease;
    }
    .ios-glass-close svg { display:block; width:20px; height:20px; }
    .ios-glass-close:focus { outline: none; box-shadow: 0 0 0 2px rgba(10,132,255,0.20), 0 4px 12px rgba(0,0,0,0.15); transform: translateY(-50%) scale(0.96); }
    .ios-glass-close:active { transform: translateY(-50%) scale(0.92); }
    .ios-glass-close:hover { background: rgba(255,255,255,0.12); }
    @media (prefers-color-scheme: dark) {
      .ios-glass-close { background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.10); box-shadow: 0 4px 12px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.02); }
      .ios-glass-close:hover { background: rgba(255,255,255,0.10); }
    }

    /* Main area sits below fixed header and supports overlays; account for 10px padding above toolbar */
    .pdf-main {
      position: relative; /* enable absolutely positioned overlays above iframe */
      background: transparent;
      padding-top: 64px; /* ensure content starts below the fixed 64px header */
      padding-bottom: calc(48px + env(safe-area-inset-bottom, 0px));
      min-height: calc(100vh - 64px);
    }

    /* PDF iframe: fill the viewport below the 64px header */
    .pdf-iframe {
      width: 100%;
      height: calc(100vh - 64px);
      border: 0;
      display: block;
      background: #ffffff;
    }

    /* full-width iOS toolbar pinned to bottom of viewport */
    .ios-toolbar{
      position: fixed;
      left: 0;
      right: 0;
      bottom: env(safe-area-inset-bottom, 0px); /* respect safe area */
      width: 100vw;
      height: auto; /* toolbar height */
      z-index: 10001; /* above header */
      display: block;
      pointer-events: auto;
      -webkit-user-select: none;
      user-select: none;
      object-fit: cover;
      /* optional subtle glass background if SVG has transparency */
      background: rgba(255,255,255,0.02);
    }
    @media (max-width: 420px) {
      .ios-toolbar { height: 48px; max-height: 48px; }
    }

  </style>

{% endblock %}
<div 
  class="ios-glass-close" 
  role="button" 
  aria-label="Close" 
  tabindex="0">
</div>